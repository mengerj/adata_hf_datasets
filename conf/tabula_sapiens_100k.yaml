# Example dataset configuration demonstrating simplified structure
# Inherits directly from dataset_default.yaml
defaults:
  - dataset_default.yaml
  - _self_

# =============================================================================
# DATASET METADATA
# =============================================================================
dataset:
  name: "tabula_sapiens_schafer"
  description: "Tabula Sapiens dataset as used in schafer et al."
  download_url: https://medical-epigenomics.org/papers/schaefer2024/data/datasets/tabula_sapiens/cellxgene.h5ad
  full_name: "tabula_sapiens_schafer"
  # file_path will be auto-generated as: data/RNA/raw/test/tabula_sapiens_bone_marrow_10k.h5ad

# =============================================================================
# COMMON KEYS (dataset-specific)
# =============================================================================
batch_key: "donor"
annotation_key: cell_ontology_class
caption_key: null
instrument_key: assay
other_bio_labels: ["organ_tissue", "cluster_label"]

# =============================================================================
# DATASET-SPECIFIC OVERRIDES
# =============================================================================
# Download configuration
download:
  enabled: false
  preserve_proportions: true
  subset_size: null

# Preprocessing overrides (both dataset-specific and execution parameters)
preprocessing:
  # Dataset-specific parameters
  enabled: true
  chunk_size: 100000
  n_chunks: 1
  split_dataset: false # Important for training datasets. Set to false for test datasets. (Similar parameters in dataset_creation)
  count_layer_key: "decontXcounts" # Key in adata.layers with raw counts. If not present, adata.raw.X is checked.

# Embedding overrides (both dataset-specific and execution parameters)
embedding_preparation:
  enabled: true
  methods: ["geneformer", "geneformer-v1"] #, "scvi_fm", "gs", "gs10k"]

embedding_cpu:
  enabled: true
  methods: ["pca", "scvi_fm", "gs10k"] #, "scvi_fm", "gs", "gs10k"]

embedding_gpu:
  enabled: true
  methods: ["geneformer", "geneformer-v1"]

# Dataset creation overrides
dataset_creation:
  enabled: false
  use_nextcloud: true
  # Dataset-specific parameters
  required_obsm_keys:
    ["X_pca", "X_scvi_fm", "X_geneformer", "X_gs", "X_gs10k", "X_geneformer-v1"]
  cs_length: 4096
  negatives_per_sample: 2
  split_dataset: false # Important for training datasets. Set to false for test datasets.
  dataset_format: "single" # Important for training datasets. Set to "single" for test datasets.
